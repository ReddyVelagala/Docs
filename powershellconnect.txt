function db-log
{
    param([string] $message)
 
    $serverName = "xxxxx"
    $databaseName = "xxxx"
    $tableName = "xxxx"
    $userId = "xxxx"
    $userPwd = "xxxx"
    $Connection = New-Object System.Data.SQLClient.SQLConnection
    $Connection.ConnectionString = "server='$serverName';database='$databaseName';User Id='$UserId';Password='$userPwd'"
    $Connection.Open()
    $Command = New-Object System.Data.SQLClient.SQLCommand
    $Command.Connection = $Connection
    $insertquery="INSERT INTO $tableName  ([LogMessage],[FunctionName])    VALUES       ('$wsName : Workspace created','CreateWorkspace Function Called')"
    $Command.CommandText = $insertquery
    $Command.ExecuteNonQuery()
    $Connection.Close()
}


function db-report-insert
{
    param([string] $worspace_id, [string] $report_id, [string] $report_name, [string] $report_url,[string] $report_embedded_url, [string] $report_dataset_id, [string] $report_datasource_id)
    
    $serverName = "xxxxx"
    $databaseName = "xxxx"
    $tableName = "xxxx"
    $userId = "xxxx"
    $userPwd = "xxxx"
    $Connection = New-Object System.Data.SQLClient.SQLConnection
    $Connection.ConnectionString = "server='$serverName';database='$databaseName';User Id='$UserId';Password='$userPwd'"
    $Connection.Open()
    $Command = New-Object System.Data.SQLClient.SQLCommand
    $Command.Connection = $Connection
    $query = "INSERT INTO '$tableName' ([WorkspaceId],[ReportId],[ReportName],[ReportURL],[ReportEmbeddedURL],[ReportDatasetId],[ReportDataSourceId]) VALUES('$worspace_id','$report_id','$report_name','$report_url','$report_embedded_url','$report_dataset_id','$report_datasource_id')"
    $Command.CommandText = $query
    $Command.ExecuteNonQuery()
    $Connection.Close()
}
function db-report-remove
{
    param([string] $workspace_id, [string] $report_id)

    $serverName = "xxxxx"
    $databaseName = "xxxx"
    $tableName = "xxxx"
    $userId = "xxxx"
    $userPwd = "xxxx"
    $Connection = New-Object System.Data.SQLClient.SQLConnection
    $Connection.ConnectionString = "server='$serverName';database='$databaseName';User Id='$UserId';Password='$userPwd'"
    $Connection.Open()
    $Command = New-Object System.Data.SQLClient.SQLCommand
    $Command.Connection = $Connection
    $query = "DELETE FROM '$tableName' WHERE [WorspaceId]='$workspace_id' AND [ReportId]='$report_id'"
    $Command.CommandText = $query
    $Command.ExecuteNonQuery()
    $Connection.Close()
}


function db-workspace-create
{
    param(int $client_id, string $workspace_id, string $workspace_name, string $workspace_url)

    $serverName = "xxxxx"
    $databaseName = "xxxx"
    $tableName = "xxxx"
    $userId = "xxxx"
    $userPwd = "xxxx"
    $sqlConn = New-Object System.Data.SqlClient.SqlConnection
    $sqlConn.ConnectionString = "Server='$serverName';database='$databaseName';User ID='$userId';Password='$userPwd'"
    $sqlConn.Open()
    $sqlcmd = $sqlConn.CreateCommand()

    $Command = New-Object System.Data.SqlClient.SqlConnection
    $Command.Connection = $sqlConn
    $query = "INSERT INTO '$tableName' ([ClientId],[WorkspaceId],[WorkspaceName],[WorkspaceURL]) VALUES('$client_id',$workspace_id','$workspace_name','$workspace_url')"
    $Command.CommandText = $query
    $Command.ExecuteNonQuery()
    $sqlConn.Close()
}
function db-workspace-remove
{
    param(string $workspace_id)

    $serverName = "xxxxx"
    $databaseName = "xxxx"
    $tableName = "xxxx"
    $userId = "xxxx"
    $userPwd = "xxxx"
    $sqlConn = New-Object System.Data.SqlClient.SqlConnection
    $sqlConn.ConnectionString = "Server='$serverName';database='$databaseName';User ID='$userId';Password='$userPwd'"
    $sqlConn.Open()
    $sqlcmd = $sqlConn.CreateCommand()

    $Command = New-Object System.Data.SqlClient.SqlConnection
    $Command.Connection = $sqlConn
    $query = "DELETE FROM '$tableName' WHERE [WorspaceId]='$workspace_id'";
    $Command.CommandText = $query
    $Command.ExecuteNonQuery()
    $sqlConn.Close()
}









